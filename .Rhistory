x <- c(NA, 2, 3, NA, NA, 6, NA, 8, 9, 10, NA)
fill_linear(x)
fill_linear(x, back = TRUE)
x <- c(NA, 2, 3, NA, NA, 6, NA, 8, 9, 10, NA,NA)
fill_linear(x)
fill_linear(x, back = TRUE)
fill_linear(x, back = TRUE,inside = F)
fill_linear(x, back = TRUE,inside = F)
fill_linear(x, back = F,inside = F)
fill_linear <- function(x, inside = TRUE, outside = TRUE, back = FALSE) {
x <- as.numeric(x)
n <- length(x)
idx <- which(!is.na(x))
if (length(idx) < 2) {
stop("At least two non-NA values are required for linear filling.")
}
y <- x
# Slopes for trend-based extrapolation
slope_start <- (x[idx[2]] - x[idx[1]]) / (idx[2] - idx[1])
slope_end   <- (x[idx[length(idx)]] - x[idx[length(idx) - 1]]) /
(idx[length(idx)] - idx[length(idx) - 1])
# ---- Inside interpolation ONLY ----
if (inside) {
inside_vals <- approx(x = idx, y = x[idx], xout = idx, method = "linear", rule = 1)$y
# Fill only positions between first and last known values
full_inside <- approx(x = idx, y = x[idx], xout = seq_len(n), method = "linear", rule = 1)$y
mid_range <- seq(idx[1], tail(idx, 1))
y[mid_range] <- full_inside[mid_range]
}
# ---- Outside extrapolation ONLY ----
if (outside) {
# Backward extrapolation
if (back && idx[1] > 1) {
for (i in seq_len(idx[1] - 1)) {
y[i] <- x[idx[1]] - slope_start * (idx[1] - i)
}
}
# Forward extrapolation
if (tail(idx, 1) < n) {
for (i in (tail(idx, 1) + 1):n) {
y[i] <- x[tail(idx, 1)] + slope_end * (i - tail(idx, 1))
}
}
}
y
}
fill_linear(x, inside = FALSE)
x <- c(NA, 2, 3, NA, NA, 6, NA, 8, 9, 10, NA,NA)
fill_linear(x)
fill_linear(x, back = F,inside = F)
fill_linear(x, back = T,inside = F)
fill_linear(x, back = T,inside = T)
library(RVD)
RVD::excel_view(iris)
library(RVD)
RVD::example(iris)
RVD::excel_view(iris)
RVD::excel_view(iris)
remove.packages("RVD")
remove.packages("RVD")
library(RVD)
library(RVD)
library(RVD)
library(tidyverse)
RVD::trimed_data(iris)
RVD::trimed_data(iris)
library(RVD)
trimed_data(iris)
library(RVD)
trimed_data(iris)
library(RVD)
trimed_data(iris)
library(RVD)
trimed_data(iris)
library(RVD)
RVD::trimed_data(iris)
